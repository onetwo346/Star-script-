<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#1a1a2e">
  <title>StarScript</title>
  <style>
    body {
      margin: 0;
      font-family: 'Inter', 'Arial', sans-serif;
      min-height: 100vh;
      transition: background 0.3s;
    }

    .cosmic {
      background: linear-gradient(135deg, #1a1a2e, #162447);
      color: #fff;
      animation: stars 20s infinite;
    }

    .light {
      background: #fff;
      color: #000;
    }

    .dark {
      background: #111;
      color: #fff;
    }

    @keyframes stars {
      0%, 100% { background-position: 0 0; }
      50% { background-position: 100% 100%; }
    }

    header {
      display: flex;
      justify-content: space-between;
      padding: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    .toolbar {
      display: flex;
      gap: 0.5rem;
      padding: 0.5rem;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      margin: 1rem;
    }

    .toolbar button, .toolbar select {
      background: #2a2a4e;
      color: #fff;
      border: none;
      padding: 0.5rem;
      border-radius: 4px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .toolbar button:hover {
      transform: scale(1.1);
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    }

    .main {
      display: flex;
      padding: 1rem;
      flex-wrap: wrap;
    }

    #editor {
      flex: 1;
      background: rgba(255, 255, 255, 0.1);
      padding: 1rem;
      border-radius: 8px;
      min-height: 400px;
      outline: none;
      margin-right: 1rem;
    }

    .chatbot, .file-manager {
      width: 100%;
      max-width: 300px;
      padding: 1rem;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      margin-top: 1rem;
    }

    .chatbot form, .file-manager form {
      display: flex;
      gap: 0.5rem;
    }

    .chatbot input, .file-manager input {
      flex: 1;
      padding: 0.5rem;
      border: none;
      border-radius: 4px;
    }

    .chatbot button, .file-manager button {
      background: #2a2a4e;
      color: #fff;
      border: none;
      padding: 0.5rem;
      border-radius: 4px;
      cursor: pointer;
    }

    .file-manager ul {
      list-style: none;
      padding: 0;
    }

    .file-manager li {
      display: flex;
      justify-content: space-between;
      padding: 0.5rem 0;
    }

    @media (min-width: 768px) {
      .chatbot, .file-manager {
        margin-top: 0;
      }
    }
  </style>
</head>
<body class="cosmic">
  <header>
    <h1>StarScript</h1>
    <button onclick="toggleTheme()">Toggle Theme</button>
  </header>
  <div class="toolbar">
    <button onclick="document.execCommand('bold')">Bold</button>
    <button onclick="document.execCommand('italic')">Italic</button>
    <button onclick="document.execCommand('underline')">Underline</button>
    <select onchange="document.execCommand('fontSize', false, this.value)">
      <option value="3">Normal</option>
      <option value="5">Large</option>
      <option value="7">Huge</option>
    </select>
    <button onclick="document.execCommand('insertUnorderedList')">Bullet List</button>
    <button onclick="document.execCommand('insertOrderedList')">Numbered List</button>
    <button onclick="saveAsTxt()">Save as TXT</button>
  </div>
  <div class="main">
    <div id="editor" contenteditable="true" oninput="updateWordCount()">
      Start writing among the stars...
    </div>
    <div class="chatbot">
      <h3>StarBot</h3>
      <form onsubmit="handleChatbotSubmit(event)">
        <input type="text" id="chatbot-input" placeholder="Type or speak a command...">
        <button type="submit">Send</button>
        <button type="button" onclick="handleVoice()">üéôÔ∏è Voice</button>
      </form>
      <p id="chatbot-response"></p>
    </div>
    <div class="file-manager">
      <h3>Files</h3>
      <form onsubmit="saveDocument(event)">
        <input type="text" id="file-name" placeholder="File name">
        <button type="submit">Save</button>
      </form>
      <ul id="file-list"></ul>
    </div>
  </div>
  <script src="https://unpkg.com/compromise@latest/builds/compromise.min.js"></script>
  <script>
    let theme = 'cosmic';
    let files = JSON.parse(localStorage.getItem('starscript-files')) || [];

    function toggleTheme() {
      theme = theme === 'cosmic' ? 'light' : theme === 'light' ? 'dark' : 'cosmic';
      document.body.className = theme;
    }

    function updateWordCount() {
      const text = document.getElementById('editor').innerText;
      const words = text.trim().split(/\s+/).length;
      console.log(`Word count: ${words}`); // Display in console for now
    }

    function saveAsTxt() {
      const content = document.getElementById('editor').innerHTML;
      const blob = new Blob([content], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'document.txt';
      a.click();
      URL.revokeObjectURL(url);
    }

    function handleVoice() {
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        document.getElementById('chatbot-input').value = transcript;
        processCommand(transcript);
      };
      recognition.start();
    }

    function processCommand(command) {
      const doc = window.nlp(command);
      const responseEl = document.getElementById('chatbot-response');
      if (doc.has('make bold')) {
        document.execCommand('bold');
        responseEl.textContent = 'Applied bold formatting.';
      } else if (doc.has('summarize')) {
        const text = document.getElementById('editor').innerText;
        const summary = window.nlp(text).sentences().slice(0, 1).text();
        responseEl.textContent = `Summary: ${summary}`;
      } else {
        responseEl.textContent = 'Command not recognized. Try "make bold" or "summarize".';
      }
    }

    function handleChatbotSubmit(event) {
      event.preventDefault();
      const input = document.getElementById('chatbot-input').value;
      processCommand(input);
      document.getElementById('chatbot-input').value = '';
    }

    function saveDocument(event) {
      event.preventDefault();
      const name = document.getElementById('file-name').value;
      if (name) {
        const content = document.getElementById('editor').innerHTML;
        files.push({ id: Date.now(), name, content });
        localStorage.setItem('starscript-files', JSON.stringify(files));
        document.getElementById('file-name').value = '';
        renderFiles();
      }
    }

    function deleteDocument(id) {
      files = files.filter(file => file.id !== id);
      localStorage.setItem('starscript-files', JSON.stringify(files));
      renderFiles();
    }

    function loadDocument(id) {
      const file = files.find(file => file.id === id);
      if (file) {
        document.getElementById('editor').innerHTML = file.content;
      }
    }

    function renderFiles() {
      const fileList = document.getElementById('file-list');
      fileList.innerHTML = '';
      files.forEach(file => {
        const li = document.createElement('li');
        li.innerHTML = `${file.name} <button onclick="loadDocument(${file.id})">Load</button> <button onclick="deleteDocument(${file.id})">Delete</button>`;
        fileList.appendChild(li);
      });
    }

    // Initialize
    renderFiles();
    updateWordCount();
  </script>
</body>
</html>
